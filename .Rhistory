2*(pnorm(4.609,lower.tail = FALSE))
5e-08
-log(5e-08)
load("C:/Users/ivanv/Desktop/Lorenz_GP_DataPrep.RData")
library(devtools)
install.packages("devtools",dependencies = TRUE)
a <- c(1:10)
b < c(2:11)
b <- c(2:11)
a+b
sum(a*b)
a*b
a
b
mapply(function(x, y) seq_len(x) + y,
c(a =  1, b = 2, c = 3),  # names from first
c(A = 10, B = 0, C = -10))
?seq_len
seq_len(1)
seq_len(2)
seq_len(3)
a <- c(1:10)
b <- c(2:11)
dot <- function(a,b) sum(a*b)
mapply(dot,a,b)
a <- c(1:10)
b <- c(2:11)
dot <- function(a,b) (a*b)
sum(mapply(dot,a,b))
?subset
?mapply(function, ...)
?mapply
?mapply
?backsolve
r <- rbind(c(1,2,3),
c(0,1,1),
c(0,0,2))
( y <- backsolve(r, x <- c(8,4,2)) ) # -1 3 1
r %*% y # == x = (8,4,2)
backsolve(r, x, transpose = TRUE)
r
a_List <- list(a[1:5],a[6:10])
b_List <- list(b[2:6],b[7:11])
sum(mapply(dot,a,b))
(mapply(dot,a,b))
(mapply(dot,a_List,b_List))
a <- c(1:10)
b <- c(2:11)
dot <- function(a,b) sum(a*b)
sum(mapply(dot,a,b))
a_List <- list(a[1:5],a[6:10])
b_List <- list(b[2:6],b[7:11])
mapply(dot,a_List,b_List)
a_List
b_List
a_List <- list(a[1:5],a[6:10])
b_List <- list(b[1:5],b[6:10])
mapply(dot,a_List,b_List)
?subset
library(rrBLUP)
?A.mat
?kin.blup
?mixed.solve
shiny::runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
shiny::runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp()
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
shiny::runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
shiny::runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
q()
library(rJava)
library(installr)
if(!require(installr)) {
install.packages("installr");
require(installr)
} #l
updateR()
q()
library(rlang)
library(rJava)
if (!require("devtools")) install.packages("devtools")
devtools::install_bitbucket(
repo = "bucklerlab/rtassel",
ref = "master",
build_vignettes = FALSE
)
Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre1.8.0_321/')
if (!require("devtools")) install.packages("devtools")
devtools::install_bitbucket(
repo = "bucklerlab/rtassel",
ref = "master",
build_vignettes = FALSE
)
remove.packages("rJava")
install.packages("rJava")
install.packages("rJava")
if (!require("devtools")) install.packages("devtools")
devtools::install_bitbucket(
repo = "bucklerlab/rtassel",
ref = "master",
build_vignettes = FALSE
)
q()
library(rTASSEL)
?filterGenotypeTableTaxa
?imputeLDKNNi
?imputeNumeric
2533+1867
4400+2457
shiny::runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2/App')
shiny::runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2App/App')
runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2App/App')
runApp()
shiny::runApp('C:/Users/ivanv/Desktop/UMN_GIT/GPSoy/SoyGen2App/App')
runApp()
shiny::runApp('C:/Users/ivanv/Desktop/UMN_GIT/PBCGSWorkshop')
library(SoyNAM)
library(NAM)
data(soynam)
geno <- markov(gen.raw)
##   Missing Information
generateNA <- function(MarkerInformation,fraction){
nLines <- length(MarkerInformation)
nLines_NA <- fraction*nLines
NA_Indices <- sample(c(1:nLines),nLines_NA)
MarkerInformation[NA_Indices] <- NA
return(MarkerInformation)
}
#Easy impute, replacing missing with marker mean
replaceNAwithMean <- function(mat){
replaceNAwithMeanVec <- function(vec){
mu <- mean(vec, na.rm=TRUE)
vec[is.na(vec)] <- mu
return(vec)
}
return(apply(mat, 2, replaceNAwithMeanVec))
}
nreps <- 10
geno_sub_list <- list()
for(nrep in 1:nreps) {
set.seed(125+nrep)
indices <- sample(c(1:nrow(geno)),1000)
geno_sub <- geno[indices,]
geno_sub_list[[nrep]] <- geno_sub
}
ImputationAccuracy_NAM_Naive_List <- list()
ImputationAccuracy_NAM_Markov_List <- list()
Fractions <- list(0.2,0.4,0.6,0.8)
NA_Mat_List_Fr <- list()
for(nFrn in 1:length(Fractions)){
NA_Mat_List_Fr[[nFrn]] <- lapply(geno_sub_list,function(y) apply(y,2,function(x) generateNA(x,Fractions[[nFrn]])))
}
length(NA_Mat_List_Fr)
lapply(NA_Mat_List_Fr,length)
g_Mat_QC_List_Naive_Frn <- lapply(NA_Mat_List_Fr,function(y) lapply(y,function(x) replaceNAwithMean(x)))
g_Mat_QC_List_Markov_Frn <- lapply(NA_Mat_List_Fr,function(y) lapply(y,function(x) markov(x)))
getwd()
setwd("C:/Users/ivanv/Desktop/UMN_GIT/PBCGSWorkshop/)
""
""
setwd("C:/Users/ivanv/Desktop/UMN_GIT/PBCGSWorkshop/")
source("GS_Pipeline_Jan_2022_FnsApp.R")
source("./GS_Pipeline_Jan_2022_FnsApp.R")
getwd()
source("./RFunctions/GS_Pipeline_Jan_2022_FnsApp.R")
source("./R_Functions/GS_Pipeline_Jan_2022_FnsApp.R")
library(vcfR)
infileVCF <- "SoyNAM_Geno.vcf"
genotypes_VCF <- read.table(infileVCF)
vcf <- read.vcfR(infileVCF, verbose = FALSE)
ls()
infileVCF <- "Data/SoyNAM_Geno.vcf"
genotypes_VCF <- read.table(infileVCF)
vcf <- read.vcfR(infileVCF, verbose = FALSE)
dim(vcf)
vcf
### Converting VCF file format to numerical matrix format that can be fit in statistical models
gt <- extract.gt(vcf, element = "GT", as.numeric = F)
fix_T <- as_tibble(getFIX(vcf))
gt2 <- matrix(0, ncol = ncol(gt), nrow = nrow(gt))
colnames(gt2) <- colnames(gt)
gt2a <- apply(gt,2, function(x) gsub("1/1","1",x))
gt2b <- gsub("0[/|]0","0",gt2a)
gt2c <- gsub("[10][/|][10]","0.5",gt2b)
gt2d <- gsub("\\.[/|]\\.","NA",gt2c)
gt2d_num <- apply(gt2d, 2, as.numeric)
dim(gt2d_num)
gt2d_num[1:5,1:5]
dim(gt2d\)
dim(gt2d)
gt2d[1:5,1:5]
SoyNAM_Accessions <- colnames(gt2d)
length(SoyNAM_Accessions)
SoyNAM_Accessions <- gsub(".","-",colnames(gt2d))
length(SoyNAM_Accessions)
SoyNAM_Accessions
SoyNAM_Accessions[1:10]
SoyNAM_Accessions <- gsub("\\.","-",colnames(gt2d))
SoyNAM_Accessions[1:10]
write.csv(SoyNAM_Accessions,"SoyNAM_Accessions.csv")
